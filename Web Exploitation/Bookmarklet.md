# [Bookmarklet](https://play.picoctf.org/practice/challenge/406)

## Challenge Information

- **Category**: Web Exploitation
- **Difficulty**: Easy
- **Description**: "Why search for the flag when I can make a bookmarklet to print it for me?"

## Solution Overview

This challenge introduces the concept of bookmarklets - special bookmarks that execute JavaScript code instead of navigating to a URL. The challenge provides an obfuscated JavaScript bookmarklet that, when executed, decrypts and displays the flag.

## Hints

1. A bookmarklet is a bookmark that runs JavaScript instead of loading a webpage.
2. What happens when you click a bookmarklet?
3. Web browsers have other ways to run JavaScript too.

## Detailed Walkthrough

### Step 1: Accessing the Challenge

After launching the instance, we navigate to the provided website. The site presents us with a bookmarklet that contains JavaScript code.

### Step 2: Examining the Bookmarklet Code

The bookmarklet code is as follows:

```javascript
javascript:(function() {
    var encryptedFlag = "àÒÆÞ¦È¬ëÙ£ÖÓÚåÛÑ¢ÕÓÓÇ¡¥Ìí";
    var key = "picoctf";
    var decryptedFlag = "";
    for (var i = 0; i < encryptedFlag.length; i++) {
        decryptedFlag += String.fromCharCode((encryptedFlag.charCodeAt(i) - key.charCodeAt(i % key.length) + 256) % 256);
    }
    alert(decryptedFlag);
})();
```

This JavaScript code:
1. Defines an encrypted flag as a string of special characters
2. Defines the encryption key as "picoctf"
3. Initializes an empty string for the decrypted flag
4. Iterates through each character of the encrypted flag
5. Performs a character-by-character XOR-like operation using the key
6. Displays the decrypted flag in an alert box

### Step 3: Executing the Bookmarklet

There are several ways to execute this JavaScript code:

1. Copy it as a bookmark in the browser
2. Paste it directly into the browser's address bar
3. Open the browser's developer console and paste the code there

For this solution, we chose to execute the code in the browser's developer console by:
1. Opening the browser's developer tools (F12 or right-click > Inspect)
2. Selecting the Console tab
3. Pasting the JavaScript code (without the "javascript:" prefix)
4. Pressing Enter to execute

### Step 4: Retrieving the Flag

Upon execution, the code displays an alert box containing the decrypted flag:

```
picoCTF{p@g3_turn3r_0c0d211f}
```

## Flag

```
picoCTF{p@g3_turn3r_0c0d211f}
```

## Learning Points

- **Bookmarklets**: Understanding how bookmarklets work as JavaScript code executed in the browser
- **Client-Side Encryption**: Recognizing that client-side encryption can be easily reversed
- **JavaScript Execution**: Learning different methods to execute JavaScript in a browser
- **XOR Encryption**: Basic understanding of simple XOR-like encryption techniques
- **Developer Tools**: Utilizing browser developer tools for security testing

## Mitigation Strategies

To protect against similar vulnerabilities:
- **Avoid Client-Side Secrets**: Never store sensitive information or encryption keys in client-side code
- **Server-Side Validation**: Implement proper server-side validation and authentication
- **Content Security Policy (CSP)**: Use CSP headers to restrict execution of unauthorized scripts
- **Obfuscation Is Not Security**: Remember that code obfuscation does not provide true security

## References

- [Bookmarklets Documentation](https://en.wikipedia.org/wiki/Bookmarklet)